Fix(CodeQL): Off-by-one index comparison against length may lead to out-of-bounds.